use alloy_primitives::{Address, B256, address, b256, hex};

/// The cheatcode handler address.
///
/// This is the same address as the one used in DappTools's HEVM.
///
/// This is calculated as:
/// `address(bytes20(uint160(uint256(keccak256('hevm cheat code')))))`
pub const CHEATCODE_ADDRESS: Address = address!("0x7109709ECfa91a80626fF3989D68f67F5b1DD12D");

/// The contract hash at [`CHEATCODE_ADDRESS`].
///
/// This is calculated as:
/// `keccak256(abi.encodePacked(CHEATCODE_ADDRESS))`.
pub const CHEATCODE_CONTRACT_HASH: B256 =
    b256!("0xb0450508e5a2349057c3b4c9c84524d62be4bb17e565dbe2df34725a26872291");

/// The Hardhat console address.
///
/// See: <https://github.com/NomicFoundation/hardhat/blob/main/v-next/hardhat/console.sol>
pub const HARDHAT_CONSOLE_ADDRESS: Address = address!("0x000000000000000000636F6e736F6c652e6c6f67");

/// Stores the caller address to be used as *sender* account for:
/// - deploying Test contracts
/// - deploying Script contracts
///
/// Derived from `address(uint160(uint256(keccak256("foundry default caller"))))`,
/// which is equal to `0x1804c8AB1F12E6bbf3894d4083f33e07309d1f38`.
pub const CALLER: Address = address!("0x1804c8AB1F12E6bbf3894d4083f33e07309d1f38");

/// The default test contract address.
///
/// Derived from `CALLER.create(1)`.
pub const TEST_CONTRACT_ADDRESS: Address = address!("0x7FA9385bE102ac3EAc297483Dd6233D62b3e1496");

/// Magic return value returned by the `assume` cheatcode.
pub const MAGIC_ASSUME: &[u8] = b"FOUNDRY::ASSUME";

/// Magic return value returned by the `skip` cheatcode. Optionally appended with a reason.
pub const MAGIC_SKIP: &[u8] = b"FOUNDRY::SKIP";

/// The address that deploys the default CREATE2 deployer contract.
pub const DEFAULT_CREATE2_DEPLOYER_DEPLOYER: Address =
    address!("0x3fAB184622Dc19b6109349B94811493BF2a45362");
/// The default CREATE2 deployer.
pub const DEFAULT_CREATE2_DEPLOYER: Address =
    address!("0x4e59b44847b379578588920ca78fbf26c0b4956c");
/// The initcode of the default CREATE2 deployer.
pub const DEFAULT_CREATE2_DEPLOYER_CODE: &[u8] = &hex!(
    "604580600e600039806000f350fe7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe03601600081602082378035828234f58015156039578182fd5b8082525050506014600cf3"
);
/// The runtime code of the default CREATE2 deployer.
pub const DEFAULT_CREATE2_DEPLOYER_RUNTIME_CODE: &[u8] = &hex!(
    "7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe03601600081602082378035828234f58015156039578182fd5b8082525050506014600cf3"
);
/// The hash of the default CREATE2 deployer code.
///
/// This is calculated as `keccak256([`DEFAULT_CREATE2_DEPLOYER_RUNTIME_CODE`])`.
pub const DEFAULT_CREATE2_DEPLOYER_CODEHASH: B256 =
    b256!("0x2fa86add0aed31f33a762c9d88e807c475bd51d0f52bd0955754b2608f7e4989");

/// The default StylusDeployer contract address on Arbitrum.
///
/// See: <https://github.com/nickytonline/stylus-deployer>
pub const DEFAULT_STYLUS_DEPLOYER: Address = address!("0xcEcba2F1DC234f70Dd89F2041029807F8D03A990");

/// The runtime code of the default StylusDeployer contract, fetched from Arbitrum mainnet.
pub const DEFAULT_STYLUS_DEPLOYER_RUNTIME_CODE: &[u8] = &hex!(
    "6080604052600436106100345760003560e01c8063835d1d4c146100395780639f40b3851461006e578063a9a8e4e91461009c575b600080fd5b34801561004557600080fd5b50610059610054366004610605565b6100d4565b60405190151581526020015b60405180910390f35b34801561007a57600080fd5b5061008e610089366004610684565b6101f0565b604051908152602001610065565b6100af6100aa3660046106d0565b610226565b60405173ffffffffffffffffffffffffffffffffffffffff9091168152602001610065565b6040517fd70c0ca700000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff82163f6004820152600090819060719063d70c0ca790602401602060405180830381865afa925050508015610161575060408051601f3d908101601f1916820190925261015e91810190610765565b60015b61016d57506000610170565b90505b607173ffffffffffffffffffffffffffffffffffffffff1663a996e0c26040518163ffffffff1660e01b8152600401602060405180830381865afa1580156101bc573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101e09190610765565b61ffff9182169116141592915050565b600083838360405160200161020793929190610787565b6040516020818303038152906040528051906020012090509392505050565b6000811561023c576102398286866101f0565b91505b600061027f88888080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250879250610534915050565b9050600061028c826100d4565b90506000811561033c5760006102a287346107a1565b6040517f58c780c200000000000000000000000000000000000000000000000000000000815273ffffffffffffffffffffffffffffffffffffffff861660048201529091506071906358c780c2908390602401604080518083038185885af1158015610312573d6000803e3d6000fd5b50505050506040513d601f19601f8201168201806040525081019061033791906107db565b925050505b86156103ff576000808473ffffffffffffffffffffffffffffffffffffffff16888b8b60405161036d929190610807565b60006040518083038185875af1925050503d80600081146103aa576040519150601f19603f3d011682016040523d82523d6000602084013e6103af565b606091505b5091509150816103f85784816040517f88d8f57d0000000000000000000000000000000000000000000000000000000081526004016103ef92919061085d565b60405180910390fd5b5050610436565b8515610436576040517ecc797100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60008661044383346107a1565b61044d91906107a1565b905080156104dc57604051600090339083908381818185875af1925050503d8060008114610497576040519150601f19603f3d011682016040523d82523d6000602084013e61049c565b606091505b50509050806104da576040517f3ea99169000000000000000000000000000000000000000000000000000000008152600481018390526024016103ef565b505b60405173ffffffffffffffffffffffffffffffffffffffff851681527f8ffcdc15a283d706d38281f500270d8b5a656918f555de0913d7455e3e6bc1bf9060200160405180910390a150919998505050505050505050565b60008251600003610571576040517f21744a5900000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6000821561058a57828451602086016000f59050610596565b8351602085016000f090505b3d1519811516156105ad576040513d6000823e3d81fd5b73ffffffffffffffffffffffffffffffffffffffff81166105fc57836040517f794c92ce0000000000000000000000000000000000000000000000000000000081526004016103ef9190610894565b90505b92915050565b60006020828403121561061757600080fd5b813573ffffffffffffffffffffffffffffffffffffffff811681146105fc57600080fd5b60008083601f84011261064d57600080fd5b50813567ffffffffffffffff81111561066557600080fd5b60208301915083602082850101111561067d57600080fd5b9250929050565b60008060006040848603121561069957600080fd5b83359250602084013567ffffffffffffffff8111156106b757600080fd5b6106c38682870161063b565b9497909650939450505050565b600080600080600080608087890312156106e957600080fd5b863567ffffffffffffffff8082111561070157600080fd5b61070d8a838b0161063b565b9098509650602089013591508082111561072657600080fd5b5061073389828a0161063b565b979a9699509760408101359660609091013595509350505050565b805161ffff8116811461076057600080fd5b919050565b60006020828403121561077757600080fd5b6107808261074e565b9392505050565b838152818360208301376000910160200190815292915050565b818103818111156105ff577f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600080604083850312156107ee57600080fd5b6107f78361074e565b9150602083015190509250929050565b8183823760009101908152919050565b6000815180845260005b8181101561083d57602081850181015186830182015201610821565b506000602082860101526020601f19601f83011685010191505092915050565b73ffffffffffffffffffffffffffffffffffffffff8316815260406020820152600061088c6040830184610817565b949350505050565b602081526000610780602083018461081756fea26469706673582212202ffe15188103190347fe5bb6d173aaf7108665ba4de6a82347fb04622c2affa064736f6c63430008110033"
);

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn create2_deployer() {
        assert_eq!(DEFAULT_CREATE2_DEPLOYER_DEPLOYER.create(0), DEFAULT_CREATE2_DEPLOYER);
    }
}
